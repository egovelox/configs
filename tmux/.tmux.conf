######################################## 
# KEY BINDINGS
########################################


# Change tmux default prefix key (C-b)
# to the old GNU Screen prefix key of C-a.
unbind C-b
set -g prefix C-a
# Allow to send the prefix to another program
bind C-a send-prefix


# key to reload config
bind r source-file $HOME/.tmux.conf \; display "Config Reloaded!"


# Keys to change pane or change window
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R


# split window
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# copy to macOS clipboard
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe 'pbcopy &> /dev/null'
# Press Enter to quit copy-mode-vi (as well as default 'q')
bind -T copy-mode-vi Enter send-keys -X cancel

########################################
# STATUS BAR
########################################


# Status bar
set -g status-position bottom
# Display status line on 2 lines
# set -g status 2
# position of window list
set -g status-justify left
set -g status-interval 5
set -g status-style "bg=#1d1f21,fg=#eceff4"
# Have a different background
# set -g status-style "bg=#4c566a,fg=#eceff4"

# Display session name
set -g status-left "#[fg=#bf616a,bg=default] #S "
# tmux-mem-cpu-load
# --averages-count 1 # will only display cpu-last-minute-average 
# --graph-lines 5 # will disply first bar if cpu-load > 20% 
# --interval should be set to corresponding tmux status-interval
# ebcb8b
#[fg=#2e3440,bg=#81a1c1,bold]
# Display the battery percentage (Mac OS)
set -g status-right "#[fg=white,bg=default,bright] üîã #(pmset -g batt | tail -1 | awk '{print $3}' | tr -d ';') #[default]"
# removed tmux-mem-cpu-load
#(tmux-mem-cpu-load -m 2 --averages-count 1 --graph-lines 5 --interval 2)
# to rely on https://github.com/samoshkin/tmux-plugin-sysstat
set -g @sysstat_mem_view_tmpl '#{mem.used} / #{mem.total}'
set -g @sysstat_cpu_view_tmpl '#{cpu.pused}'
set -ag status-right "#{prefix_highlight} #[fg=#A9B53F,bg=default] ‚öôÔ∏è #{sysstat_mem} | #{sysstat_loadavg} " 
set -g status-right-length 70
set -ga status-right "#{prefix_highlight} #[fg=#bf616a,bg=default] %a %d %H:%M "
# ifconfig en0 inet | grep inet | cut -d' ' -f2

setw -g window-status-format '#[fg=#81a1c1,bg=#2c3445] #I:#{=/-15/‚Ä¶:pane_title} '
setw -g window-status-current-format '#[fg=#2e3440,bg=#81a1c1,bold] #I:#{=/-15/‚Ä¶:pane_title} '
setw -g window-status-separator " "


# Fix titlebar
set -g set-titles on
set -g set-titles-string "#T"


# make window/pane index start with 1
set -g base-index 1
setw -g pane-base-index 1


########################################
# OTHER SETTINGS
########################################


# default shell
set -g default-shell /usr/local/bin/fish
set -g default-command /usr/local/bin/fish


# helps in faster key repetition Avoid ESC delay
set -sg escape-time 0


# set scroll history to 100,000 lines
set-option -g history-limit 100000

# Vim mode
# To enter, use default enter binding : prefix-[
# To quit, use default quit binding : q
setw -g mode-keys vi

# Mouse friendly
set -g mouse on


########################################
# TPM SETTINGS
########################################
# required: git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm


# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'samoshkin/tmux-plugin-sysstat'
# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'github_username/plugin_name#branch'
# set -g @plugin 'git@github.com:user/plugin'
# set -g @plugin 'git@bitbucket.com:user/plugin'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
